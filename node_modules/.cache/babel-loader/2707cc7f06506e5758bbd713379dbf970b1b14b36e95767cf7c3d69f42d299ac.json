{"ast":null,"code":"var _jsxFileName = \"/Users/macbookair/Desktop/AeroJobs/AeroJob/frontend/src/components/SurveyPrompt.js\",\n  _s = $RefreshSig$();\n// src/components/SurveyPrompt.js\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { surveysAPI } from '../utils/api';\nimport { X, Star } from 'lucide-react';\nimport toast from 'react-hot-toast';\n\n/**\n * Props (all optional for auto-prompt mode):\n * - open: boolean (controlled mode)\n * - onClose: () => void\n * - survey: survey object (when opened from a button)\n * - onSubmitted: () => void (notify parent after submit)\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function SurveyPrompt(props) {\n  _s();\n  const controlled = typeof props.open === 'boolean' || !!props.survey;\n  const [internalOpen, setInternalOpen] = useState(false);\n  const [internalSurvey, setInternalSurvey] = useState(null);\n\n  // choose source depending on mode\n  const open = controlled ? props.open : internalOpen;\n  const survey = controlled ? props.survey : internalSurvey;\n  const [answers, setAnswers] = useState({});\n  const [saving, setSaving] = useState(false);\n\n  // Auto-prompt mode: fetch on mount\n  useEffect(() => {\n    if (controlled) return; // parent handles opening\n    (async () => {\n      try {\n        const s = await surveysAPI.eligibleActive(); // alias to forMe()\n        if (s) {\n          setInternalSurvey(s);\n          setInternalOpen(true);\n        }\n      } catch {\n        /* ignore silently */\n      }\n    })();\n  }, [controlled]);\n  const questions = useMemo(() => {\n    const arr = Array.isArray(survey === null || survey === void 0 ? void 0 : survey.questions) ? survey.questions : [];\n    // stable sort if 'order' exists\n    const sorted = [...arr].sort((a, b) => (a.order || 0) - (b.order || 0));\n    return sorted.map((q, idx) => ({\n      ...q,\n      _qid: q._id || q.id || `q${idx}`,\n      scaleMax: Number(q === null || q === void 0 ? void 0 : q.scaleMax) > 0 ? Number(q.scaleMax) : 5\n    }));\n  }, [survey]);\n  useEffect(() => {\n    // re-init answers when a new survey opens\n    const init = {};\n    questions.forEach(q => {\n      if (q.type === 'checkbox') init[q._qid] = [];else init[q._qid] = '';\n    });\n    setAnswers(init);\n  }, [questions]);\n  if (!survey || !open) return null;\n  const setAnswer = (q, val) => {\n    setAnswers(a => ({\n      ...a,\n      [q._qid]: val\n    }));\n  };\n  const close = () => {\n    var _props$onClose;\n    if (controlled) (_props$onClose = props.onClose) === null || _props$onClose === void 0 ? void 0 : _props$onClose.call(props);else setInternalOpen(false);\n  };\n  const requiredMissing = () => {\n    for (const q of questions) {\n      if (!q.required) continue;\n      const v = answers[q._qid];\n      if (q.type === 'checkbox') {\n        if (!Array.isArray(v) || v.length === 0) return q;\n      } else if (q.type === 'rating') {\n        if (!v || Number(v) <= 0) return q;\n      } else {\n        if (v === '' || v == null) return q;\n      }\n    }\n    return null;\n  };\n  const submit = async () => {\n    const miss = requiredMissing();\n    if (miss) {\n      toast.error(`Please answer: ${miss.text || miss.label || 'Required question'}`);\n      return;\n    }\n    setSaving(true);\n    try {\n      var _props$onSubmitted;\n      const payload = {\n        answers: questions.map(q => {\n          var _answers$q$_qid;\n          return {\n            questionId: q._id || q.id || q._qid,\n            value: (_answers$q$_qid = answers[q._qid]) !== null && _answers$q$_qid !== void 0 ? _answers$q$_qid : q.type === 'checkbox' ? [] : '',\n            type: q.type,\n            label: q.text || q.label\n          };\n        })\n      };\n      await surveysAPI.submit(survey._id, payload); // alias to submitResponse()\n      toast.success('Thanks for your response!');\n      (_props$onSubmitted = props.onSubmitted) === null || _props$onSubmitted === void 0 ? void 0 : _props$onSubmitted.call(props);\n      close();\n    } catch (e) {\n      var _e$response, _e$response$data;\n      const msg = (e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.error) || (e === null || e === void 0 ? void 0 : e.message) || 'Please complete required questions';\n      toast.error(msg);\n    } finally {\n      setSaving(false);\n    }\n  };\n  const Rating = ({\n    q\n  }) => {\n    const value = Number(answers[q._qid] || 0);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-2\",\n      children: [Array.from({\n        length: q.scaleMax || 5\n      }).map((_, i) => {\n        const n = i + 1;\n        const active = value >= n;\n        return /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => setAnswer(q, n),\n          className: `p-2 rounded-md border transition ${active ? 'border-yellow-400 bg-yellow-50' : 'border-gray-200'}`,\n          children: /*#__PURE__*/_jsxDEV(Star, {\n            className: `w-5 h-5 ${active ? 'fill-yellow-400' : ''}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 15\n          }, this)\n        }, n, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 13\n        }, this);\n      }), value ? /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"ml-2 text-sm opacity-70\",\n        children: [value, \"/\", q.scaleMax || 5]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 18\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this);\n  };\n  const Question = ({\n    q,\n    idx\n  }) => {\n    const t = (q.type || '').toLowerCase();\n    const val = answers[q._qid];\n    if (t === 'text') {\n      return /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"input w-full\",\n        onChange: e => setAnswer(q, e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, this);\n    }\n    if (t === 'textarea' || t === 'essay' || t === 'paragraph' || t === 'short_essay') {\n      return /*#__PURE__*/_jsxDEV(\"textarea\", {\n        className: \"input w-full\",\n        rows: 3,\n        onChange: e => setAnswer(q, e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }, this);\n    }\n    if (t === 'radio' || t === 'choice' || t === 'single') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col gap-2\",\n        children: (q.options || []).map(opt => {\n          const id = `${q._qid}-${opt}`;\n          return /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              name: q._qid,\n              value: opt,\n              onChange: e => setAnswer(q, e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: opt\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 17\n            }, this)]\n          }, id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this);\n    }\n    if (t === 'checkbox' || t === 'multi') {\n      const arr = Array.isArray(val) ? val : [];\n      const toggle = opt => {\n        if (arr.includes(opt)) setAnswer(q, arr.filter(x => x !== opt));else setAnswer(q, [...arr, opt]);\n      };\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col gap-2\",\n        children: (q.options || []).map(opt => {\n          const id = `${q._qid}-${opt}`;\n          const checked = arr.includes(opt);\n          return /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: checked,\n              onChange: () => toggle(opt)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: opt\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 17\n            }, this)]\n          }, id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, this);\n    }\n    if (t === 'rating') {\n      return /*#__PURE__*/_jsxDEV(Rating, {\n        q: q\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 14\n      }, this);\n    }\n    // default to text\n    return /*#__PURE__*/_jsxDEV(\"input\", {\n      className: \"input w-full\",\n      onChange: e => setAnswer(q, e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-auto shadow-xl\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 border-b flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold\",\n          children: survey.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: close,\n          className: \"btn btn-ghost\",\n          \"aria-label\": \"Close\",\n          children: /*#__PURE__*/_jsxDEV(X, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4\",\n        children: [survey.description && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mb-3 opacity-80\",\n          children: survey.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 34\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid gap-4\",\n          children: questions.map((q, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"font-medium mb-1\",\n              children: [\"Q\", idx + 1, \". \", q.text || q.label, ' ', q.required && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-red-500\",\n                children: \"*\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 225,\n                columnNumber: 34\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Question, {\n              q: q,\n              idx: idx\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 17\n            }, this)]\n          }, q._qid, true, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 border-t flex justify-end\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-primary\",\n          disabled: saving,\n          onClick: submit,\n          children: saving ? 'Submitting…' : 'Submit'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 208,\n    columnNumber: 5\n  }, this);\n}\n_s(SurveyPrompt, \"fi5d+aU7Luzg+oJpOCnjYbF0bzQ=\");\n_c = SurveyPrompt;\nvar _c;\n$RefreshReg$(_c, \"SurveyPrompt\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","surveysAPI","X","Star","toast","jsxDEV","_jsxDEV","SurveyPrompt","props","_s","controlled","open","survey","internalOpen","setInternalOpen","internalSurvey","setInternalSurvey","answers","setAnswers","saving","setSaving","s","eligibleActive","questions","arr","Array","isArray","sorted","sort","a","b","order","map","q","idx","_qid","_id","id","scaleMax","Number","init","forEach","type","setAnswer","val","close","_props$onClose","onClose","call","requiredMissing","required","v","length","submit","miss","error","text","label","_props$onSubmitted","payload","_answers$q$_qid","questionId","value","success","onSubmitted","e","_e$response","_e$response$data","msg","response","data","message","Rating","className","children","from","_","i","n","active","onClick","fileName","_jsxFileName","lineNumber","columnNumber","Question","t","toLowerCase","onChange","target","rows","options","opt","name","toggle","includes","filter","x","checked","title","description","disabled","_c","$RefreshReg$"],"sources":["/Users/macbookair/Desktop/AeroJobs/AeroJob/frontend/src/components/SurveyPrompt.js"],"sourcesContent":["// src/components/SurveyPrompt.js\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { surveysAPI } from '../utils/api';\nimport { X, Star } from 'lucide-react';\nimport toast from 'react-hot-toast';\n\n/**\n * Props (all optional for auto-prompt mode):\n * - open: boolean (controlled mode)\n * - onClose: () => void\n * - survey: survey object (when opened from a button)\n * - onSubmitted: () => void (notify parent after submit)\n */\nexport default function SurveyPrompt(props) {\n  const controlled = typeof props.open === 'boolean' || !!props.survey;\n  const [internalOpen, setInternalOpen] = useState(false);\n  const [internalSurvey, setInternalSurvey] = useState(null);\n\n  // choose source depending on mode\n  const open = controlled ? props.open : internalOpen;\n  const survey = controlled ? props.survey : internalSurvey;\n\n  const [answers, setAnswers] = useState({});\n  const [saving, setSaving] = useState(false);\n\n  // Auto-prompt mode: fetch on mount\n  useEffect(() => {\n    if (controlled) return; // parent handles opening\n    (async () => {\n      try {\n        const s = await surveysAPI.eligibleActive(); // alias to forMe()\n        if (s) {\n          setInternalSurvey(s);\n          setInternalOpen(true);\n        }\n      } catch {\n        /* ignore silently */\n      }\n    })();\n  }, [controlled]);\n\n  const questions = useMemo(() => {\n    const arr = Array.isArray(survey?.questions) ? survey.questions : [];\n    // stable sort if 'order' exists\n    const sorted = [...arr].sort((a, b) => (a.order || 0) - (b.order || 0));\n    return sorted.map((q, idx) => ({\n      ...q,\n      _qid: q._id || q.id || `q${idx}`,\n      scaleMax: Number(q?.scaleMax) > 0 ? Number(q.scaleMax) : 5,\n    }));\n  }, [survey]);\n\n  useEffect(() => {\n    // re-init answers when a new survey opens\n    const init = {};\n    questions.forEach((q) => {\n      if (q.type === 'checkbox') init[q._qid] = [];\n      else init[q._qid] = '';\n    });\n    setAnswers(init);\n  }, [questions]);\n\n  if (!survey || !open) return null;\n\n  const setAnswer = (q, val) => {\n    setAnswers((a) => ({ ...a, [q._qid]: val }));\n  };\n\n  const close = () => {\n    if (controlled) props.onClose?.();\n    else setInternalOpen(false);\n  };\n\n  const requiredMissing = () => {\n    for (const q of questions) {\n      if (!q.required) continue;\n      const v = answers[q._qid];\n      if (q.type === 'checkbox') {\n        if (!Array.isArray(v) || v.length === 0) return q;\n      } else if (q.type === 'rating') {\n        if (!v || Number(v) <= 0) return q;\n      } else {\n        if (v === '' || v == null) return q;\n      }\n    }\n    return null;\n  };\n\n  const submit = async () => {\n    const miss = requiredMissing();\n    if (miss) {\n      toast.error(`Please answer: ${miss.text || miss.label || 'Required question'}`);\n      return;\n    }\n\n    setSaving(true);\n    try {\n      const payload = {\n        answers: questions.map((q) => ({\n          questionId: q._id || q.id || q._qid,\n          value: answers[q._qid] ?? (q.type === 'checkbox' ? [] : ''),\n          type: q.type,\n          label: q.text || q.label,\n        })),\n      };\n      await surveysAPI.submit(survey._id, payload); // alias to submitResponse()\n      toast.success('Thanks for your response!');\n      props.onSubmitted?.();\n      close();\n    } catch (e) {\n      const msg = e?.response?.data?.error || e?.message || 'Please complete required questions';\n      toast.error(msg);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const Rating = ({ q }) => {\n    const value = Number(answers[q._qid] || 0);\n    return (\n      <div className=\"flex items-center gap-2\">\n        {Array.from({ length: q.scaleMax || 5 }).map((_, i) => {\n          const n = i + 1;\n          const active = value >= n;\n          return (\n            <button\n              key={n}\n              type=\"button\"\n              onClick={() => setAnswer(q, n)}\n              className={`p-2 rounded-md border transition ${\n                active ? 'border-yellow-400 bg-yellow-50' : 'border-gray-200'\n              }`}\n            >\n              <Star className={`w-5 h-5 ${active ? 'fill-yellow-400' : ''}`} />\n            </button>\n          );\n        })}\n        {value ? <span className=\"ml-2 text-sm opacity-70\">{value}/{q.scaleMax || 5}</span> : null}\n      </div>\n    );\n  };\n\n  const Question = ({ q, idx }) => {\n    const t = (q.type || '').toLowerCase();\n    const val = answers[q._qid];\n\n    if (t === 'text') {\n      return (\n        <input className=\"input w-full\" onChange={(e) => setAnswer(q, e.target.value)} />\n      );\n    }\n    if (t === 'textarea' || t === 'essay' || t === 'paragraph' || t === 'short_essay') {\n      return (\n        <textarea className=\"input w-full\" rows={3} onChange={(e) => setAnswer(q, e.target.value)} />\n      );\n    }\n    if (t === 'radio' || t === 'choice' || t === 'single') {\n      return (\n        <div className=\"flex flex-col gap-2\">\n          {(q.options || []).map((opt) => {\n            const id = `${q._qid}-${opt}`;\n            return (\n              <label key={id} className=\"flex items-center gap-2\">\n                <input\n                  type=\"radio\"\n                  name={q._qid}\n                  value={opt}\n                  onChange={(e) => setAnswer(q, e.target.value)}\n                />\n                <span>{opt}</span>\n              </label>\n            );\n          })}\n        </div>\n      );\n    }\n    if (t === 'checkbox' || t === 'multi') {\n      const arr = Array.isArray(val) ? val : [];\n      const toggle = (opt) => {\n        if (arr.includes(opt)) setAnswer(q, arr.filter((x) => x !== opt));\n        else setAnswer(q, [...arr, opt]);\n      };\n      return (\n        <div className=\"flex flex-col gap-2\">\n          {(q.options || []).map((opt) => {\n            const id = `${q._qid}-${opt}`;\n            const checked = arr.includes(opt);\n            return (\n              <label key={id} className=\"flex items-center gap-2\">\n                <input type=\"checkbox\" checked={checked} onChange={() => toggle(opt)} />\n                <span>{opt}</span>\n              </label>\n            );\n          })}\n        </div>\n      );\n    }\n    if (t === 'rating') {\n      return <Rating q={q} />;\n    }\n    // default to text\n    return (\n      <input className=\"input w-full\" onChange={(e) => setAnswer(q, e.target.value)} />\n    );\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4\">\n      <div className=\"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-auto shadow-xl\">\n        <div className=\"p-4 border-b flex items-center justify-between\">\n          <h3 className=\"text-lg font-semibold\">{survey.title}</h3>\n          <button onClick={close} className=\"btn btn-ghost\" aria-label=\"Close\">\n            <X />\n          </button>\n        </div>\n\n        <div className=\"p-4\">\n          {survey.description && <p className=\"mb-3 opacity-80\">{survey.description}</p>}\n\n          <div className=\"grid gap-4\">\n            {questions.map((q, idx) => (\n              <div key={q._qid}>\n                <div className=\"font-medium mb-1\">\n                  Q{idx + 1}. {q.text || q.label}{' '}\n                  {q.required && <span className=\"text-red-500\">*</span>}\n                </div>\n                <Question q={q} idx={idx} />\n              </div>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"p-4 border-t flex justify-end\">\n          <button className=\"btn btn-primary\" disabled={saving} onClick={submit}>\n            {saving ? 'Submitting…' : 'Submit'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}